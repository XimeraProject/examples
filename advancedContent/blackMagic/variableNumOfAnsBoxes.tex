\documentclass{ximera}
\title{Generating Answer Boxes}


\author{Jason Nowell}
\begin{document}
\begin{abstract}
    How to generate a custom number of answer boxes on the fly via sage.
\end{abstract}
\maketitle


\begin{sagesilent}
##### Useful Macros
def RandInt(a,b):
    """ Returns a random integer in [`a`,`b`]. Note that `a` and `b` should be integers themselves to avoid unexpected behavior.
    """
    return QQ(randint(int(a),int(b)))
    # return choice(range(a,b+1))

def NonZeroInt(b,c, avoid = [0]):
    """ Returns a random integer in [`b`,`c`] which is not in `av`. 
        If `av` is not specified, defaults to a non-zero integer.
    """
    while True:
        a = RandInt(b,c)
        if a not in avoid:
            return a

#### Problem 1:

p1c1 = RandInt(1,100)
p1c2 = NonZeroInt(1,100,[p1c1])
p1f1 = NonZeroInt(-5,5)*x^3 + RandInt(-5,5)*x + RandInt(-5,5)
if p1c1>50:
    p1ans1 = p1c2
    p1ans2 = LatexExpr(r'\answer{'+latex(p1f1)+'}')
else:
    p1ans1 = p1c1
    p1ans2=''
    



\end{sagesilent}
   
   
\subsection*{The Problem}
     Often, when randomizing content, you can run into an issue where you could produce a variable number of answers. For example, lets say a problem randomly generates a quadratic function by picking both zeros and then expanding the expression $(x-a)*(x-b)$. You can then have two answer boxes, one with answer of $a$ and one with answer $b$. But what happens if you want to ask for distinct zeros? Do you force $a \neq b$ and risk students assuming quadratics \textit{always} have distinct zeros? Or do you ask for the sum of solutions, and risk student confusion and/or finding shortcuts (like noticing that the sum would be the coefficient to the $x$ term)? If only you could somehow provide 1 answer box when there is only 1 distinct zero, and 2 answer boxes if there are 2 distinct zeros?
    
\subsection*{The Solution}
    It turns out you can, using sage code with the LatexExpr command. Doing this can be a little tricky, since the input needs to be a string, but it allows you to put entire segments of LaTeX code into the sage environment - where the randomizing is taken place, then emit that content to the page to be processed by LaTeX. In particular, you can put the \verb|\answer\verb| command into sage, and generate it (or not) depending on conditions in sage. Consider the following:


    \begin{problem}
        I selected a number between 1 and 100. The value sage returned is $\sage{p1c1}$. If that number is less than (or equal to) $50$ then there should be one answer box, whose answer will be $\sage{p1c1}$. If the number is greater than 50, then the first answer box's answer should be $\sage{p1c2}$, and there should be a second answer box, whose answer should be a polynomial randomly generated by sage - in particular the answer should be: $\sage{p1f1}$.
        
        Answer Box 1: $\answer{\sage{p1ans1}}$
        
        Answer Box 2 (will generate if it should, or won't if it shouldn't!): $\sage{p1ans2}$
        
        Feel free to hit the ``Another'' button above until you get both results!
    \end{problem}




        
\end{document}